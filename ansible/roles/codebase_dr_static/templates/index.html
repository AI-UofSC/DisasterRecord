<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8' />
    <title></title>
    <link href="https://fonts.googleapis.com/css?family=Poppins" rel="stylesheet">
    <!-- <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' /> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.css' rel='stylesheet' />
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.0.9/mapbox-gl-draw.css' type='text/css'
    />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/bootstrap/3/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/static/css/main.css" />
    <link rel="stylesheet" type="text/css" href="/static/css/animate.min.css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU"
        crossorigin="anonymous">


    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA7YOOWjDL1lO3n96oXc4_KPPrJL79ZCpY&libraries=drawing"></script>

    <style>
        .mapboxgl-popup-content {
            display: inline-block;
        }
    </style>
</head>

<body>
    <section class="container">

        <div class="one">

            <div id='rib'>
                <img src="/static/drecord-logo.png" style="margin-top: -10%;" class="top_img">
                <div id="drec">Disaster
                    <br> Record</div>
                <a href="/{{ endpointroot }}manageCampaign/{% raw %}{{ campaignName }}{% endraw %}"><i class="fas fa-cog" id="admin_gear"></i></a>
            </div>
            <div id="date-picker">
                <h4 style="text-align: center;">Pick a Date/Time Range</h4>
                    <div class="timepicker" style="margin-bottom: 3%;">
                        <input type="text" name="daterange" value="08-16-2018 1:30 PM - 08-21-2018 2:00 PM" id="daterange"/>
                    </div>
            </div>
            <div id="user_select">
                <label class="radio inline">
                    <input type="radio" name="user_lvl" value="individual">
                    <span> Individual </span>
                </label>
                <label class="radio inline">
                    <input type="radio" name="user_lvl" value="aggregated" checked>
                    <span>Aggregated </span>
                </label>
            </div>
            <br>
            <nav id="menu"></nav>
            <div id='instructions'></div>
            <div id="steps">
                Hold
                <img src='/static/shift.png' height='45px' style="vertical-align: middle !important;"> and drag on top of the map to create a bounding Box.
                <br>
                <br>
                <br> Click on resulting features to see related tweets.
            </div>
            <div id='agg_content'>
                <br>
                <div id="date_holder"></div>
                <div class="list_head">Text Features:</div>
                <table class="text_agg_list"></table>
                <div class="list_head">Image Features:</div>
                <table class="img_agg_list"></table>
                <div class="list_head">OSM Features:</div>
                <table class="osm_agg_list"></table>
                <!-- <div class="list_head">Word Cloud:</div> -->


            </div>
            <div id="picture"></div>
            <!--
            <div id='logo'>
            <div id='hazard'>
                <img height="55px" src="/static/hazard.png">
                <span id="kno">Kno.e.sis</span>
            </div>
            <div id='nsf'>
                <img height="60px" src="/static/NSF.png">

            </div>
            -->
            <a href="https://icons8.com" id="icon_p">Icon pack by Icons8</a>
        </div>
        </div>

        <div class="zero">
                <div id='close_zero'>
                        <i class="fas fa-times-circle" id="close"></i>
                    </div>
            <div id="zero_top">

                <div id="zero_topic"></div>
            </div>
            <div id='zero_container'>

            </div>
        </div>
        <div class="two">

            <div id='map'></div>

        </div>
        <img id="loadingGif" src="/static/Spin.gif" style="position:absolute; margin:auto; top:0; left:0; right:0; bottom:0;" width="100"
            alt="Loading">
    </section>

    <script type="text/javascript">
        var centroid = {% raw %}{{ centroid | tojson | safe }}{% endraw %},
        campaign_esname = {% raw %}{{ campaign_esname | tojson | safe }}{% endraw %},
        campaign_date_start = {% raw %}{{ campaign_date_start | tojson | safe }}{% endraw %},
        campaign_date_end = {% raw %}{{ campaign_date_end | tojson | safe }}{% endraw %},
        campaign_default_zoom = {% raw %}{{ campaign_default_zoom | tojson | safe }}{% endraw %},
        media_data = {% raw %}{{ media_data | tojson | safe }}{% endraw %},
        campaign_BB = {% raw %}{{ campaign_BB | tojson | safe }}{% endraw %},
        OSM_features_icons_dict = {% raw %}{{ OSM_features_icons_dict| tojson | safe }}{% endraw %},
        sd = {% raw %}{{ shelter_data | tojson | safe }}{% endraw %},
        rd = {% raw %}{{ rescue_data | tojson | safe }}{% endraw %},
        ps = {% raw %}{{ photon_shelter | tojson | safe }}{% endraw %},
        pr = {% raw %}{{ photon_rescue | tojson | safe }}{% endraw %},
        os = {% raw %}{{ other_sh | tojson | safe }}{% endraw %},
        or = {% raw %}{{ other_res | tojson | safe }}{% endraw %};

    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script>
    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.0.9/mapbox-gl-draw.js'></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js"></script>

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
    <script type="text/javascript" src="/static/js/map.js"></script>

    <script type="text/javascript"> 
        $('input[name="daterange"]').daterangepicker(
          {
            minYear: 2000,
            maxYear: 3000,
            timePicker: true,
            ranges: {
              Today: [moment(), moment()],
              Yesterday: [moment().subtract(1, "days"), moment().subtract(1, "days")],
              "Last 7 Days": [moment().subtract(6, "days"), moment()],
              "Last 30 Days": [moment().subtract(29, "days"), moment()],
              "This Month": [moment().startOf("month"), moment().endOf("month")],
              "Last Month": [
                moment()
                  .subtract(1, "month")
                  .startOf("month"),
                moment()
                  .subtract(1, "month")
                  .endOf("month")
              ]
            },
            alwaysShowCalendars: true,
            startDate: campaign_date_start[0],   //"08/01/2017"
            endDate: campaign_date_end[0],     //"12/29/2017"
            opens: "left"
          },
          function(start, end, label) {
            var st = start.valueOf();
            var ed = end.valueOf();
            console.log(typeof st);
            console.log(typeof ed);
            var start_filter = [">=", "uxtm", st];
            var end_filter = ["<", "uxtm", ed];
            console.log(st + " " + ed);
            // $('.three').css('display','block');
            
             map.setFilter('Shelter/Food/Supplies Need',['all',start_filter,end_filter]);
             map.setFilter('Medical/Rescue Help Need',['all',start_filter,end_filter]);
            //map.setFilter('Utility/Infrastructure Problem',['all',start_filter,end_filter]);
          }
        );
    </script>


    <script type="text/javascript" src="/static/js/main.js"></script>
    <script type="text/javascript" src="/static/js/underscore.js"></script>
    <script type="text/javascript" src="/static/js/d3.js"></script>
    <script type="text/javascript" src="/static/js/calheatmap.js"></script>
    <script type="text/javascript" src="/static/js/heatmap.js"></script>

</body>

</html>